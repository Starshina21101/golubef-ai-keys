document.addEventListener("DOMContentLoaded", () => {
    const section = document.querySelector('.cases-v3-section');
    if (!section) return;

    const animateCounters = (entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const counters = entry.target.querySelectorAll('.counter');
                counters.forEach(counter => {
                    const target = +counter.getAttribute('data-target');
                    let current = 0;
                    
                    const updateCounter = () => {
                        const increment = target / 100; // Анимация за ~100 шагов
                        
                        if (current < target) {
                            current += increment;
                            if (current > target) current = target;
                            counter.innerText = Math.ceil(current);
                            requestAnimationFrame(updateCounter);
                        } else {
                            counter.innerText = target;
                        }
                    };
                    updateCounter();
                });
                observer.unobserve(entry.target); // Запускаем анимацию один раз
            }
        });
    };

    const observer = new IntersectionObserver(animateCounters, {
        threshold: 0.5 // Запускать, когда 50% блока видно
    });

    observer.observe(section);
});
